{% extends "base.html" %}
{% block content %}
<main>
    <section class = "container my-4">
        <div class = "row">
            <div class = "col-3">
                {% include "user/left-sidebar.html" %}
            </div>
            <div class = "col-9">
                <h3 class = "mb-4 border-bottom pb-1">Notifications <span class = "badge bg-primary">123</span></h3>
                <span class"ajaxRes"></span>
                <ul class = "list-group notify-list">
                    Loading...
                </ul>
            </div>
        </div> 
    </section>
</main>

<script type = "text/javascript">
    $(document).ready(function(){
        $(".ajaxRes").hide();
        setInterval(function(){
            $.ajax({
                url:"{% url 'get_notify' %}",
                dataType:'json',
                beforeSend: function(){
                    $(".ajaxRes").show();
                    $(".ajaxRes").text('Loading...');
                },
                success: function(res){
                    _html = '';
                    _json = $.parseJSON(res.data);
                    $.each(_json, function(index, d){
                        _html += '<li class = "list-group-item bg-secondary-subtle">'+d.fields.notify_detail+'<button class = "btn btn-sm btn-primary float-end">Mark Read</button></li>';
                    });
                    $(".notify-list").html(_html);
                    $(".ajaxRes").hide();
                }
            });
        }, 5000);
    });
</script>
{% endblock %}